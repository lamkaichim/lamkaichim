<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg"
     xmlns:xlink="http://www.w3.org/1999/xlink"
     viewBox="0 0 600 100"
     preserveAspectRatio="xMidYMid slice">

  <!-- 1. 定义 typewriter 样式 -->
  <defs>
    <style type="text/css"><![CDATA[
      /* 为所有文字元素添加光标 caret 效果，不影响现有 fill 色 */
      .typewriter {
        box-sizing: content-box;                /* 保证宽度不包含 caret */
        border-right: 4px solid currentColor;   /* 4px 宽光标，跟文字颜色一致 */ :contentReference[oaicite:0]{index=0}
      }
    ]]></style>
  </defs>

  <!-- 2. 背景色按段离散切换（保持不变） -->
  <rect id="bg" width="100%" height="100%" fill="{{COLOR_BG}}"/>
  <set href="#bg" attributeName="fill" to="{{COLOR_BG}}"  begin="seg1del.begin"/>
  <set href="#bg" attributeName="fill" to="#4e3874"      begin="seg2del.begin"/>
  <set href="#bg" attributeName="fill" to="#016109"      begin="seg3del.begin"/>
  <set href="#bg" attributeName="fill" to="#7e3a6a"      begin="seg4del.begin"/>

  <!-- Segment 1 -->
  <g id="seg1" visibility="visible">
    <path id="p1" d="M0,50 H0" fill="none"/>
    <animate id="seg1draw" href="#p1" attributeName="d"
             values="M0,50 H0;M0,50 H500" dur="2s"
             begin="0s;loop.end+0.1s" fill="freeze"/>
    <animate id="seg1del" href="#p1" attributeName="d"
             values="M0,50 H500;M0,50 H0" dur="1s"
             begin="seg1draw.end" fill="freeze"/>
    <set attributeName="visibility" to="hidden" begin="seg1del.end+1s"/>
    <set href="#seg1" attributeName="visibility" to="visible" begin="loop.begin"/>

    <!-- 在此处添加 class="typewriter" -->
    <text id="text1" class="typewriter"
          font-family="system-ui" font-size="32" font-weight="bold"
          text-anchor="middle" x="50%" y="50" dominant-baseline="middle"
          fill="#eb98fd">
      <textPath href="#p1">第一段文字</textPath>
      <set attributeName="fill" to="#eb98fd" begin="seg1del.begin"/>
    </text>
    <text class="typewriter" visibility="hidden"
          font-family="system-ui" font-size="32" font-weight="bold"
          text-anchor="middle" x="50%" y="50" dominant-baseline="middle"
          fill="#eb98fd">
      <textPath href="#p1" startOffset="100%">|</textPath>
      <animate attributeName="opacity" values="1;0;1" dur="1s"
               begin="seg1del.end" repeatCount="1" calcMode="discrete"/>
      <set attributeName="visibility" to="visible" begin="seg1del.end"/>
    </text>
    <set attributeName="visibility" to="hidden" begin="seg1del.end+1s"/>
  </g>

  <!-- Segment 2 -->
  <g id="seg2" visibility="hidden">
    <path id="p2" d="M0,50 H0" fill="none"/>
    <animate id="seg2draw" href="#p2" attributeName="d"
             values="M0,50 H0;M0,50 H500" dur="2s"
             begin="seg1del.end" fill="freeze"/>
    <animate id="seg2del" href="#p2" attributeName="d"
             values="M0,50 H500;M0,50 H0" dur="1s"
             begin="seg2draw.end" fill="freeze"/>
    <text id="text2" class="typewriter"
          font-family="system-ui" font-size="32" font-weight="bold"
          text-anchor="middle" x="50%" y="50" dominant-baseline="middle"
          fill="#dde8cb">
      <textPath href="#p2">第二段文字</textPath>
      <set attributeName="fill" to="#dde8cb" begin="seg2del.begin"/>
    </text>
    <text class="typewriter" visibility="hidden"
          font-family="system-ui" font-size="32" font-weight="bold"
          text-anchor="middle" x="50%" y="50" dominant-baseline="middle"
          fill="#dde8cb">
      <textPath href="#p2" startOffset="100%">|</textPath>
      <animate attributeName="opacity" values="1;0;1" dur="1s"
               begin="seg2del.end" repeatCount="1" calcMode="discrete"/>
      <set attributeName="visibility" to="visible" begin="seg2del.end"/>
    </text>
    <set attributeName="visibility" to="visible" begin="seg1del.end"/>
    <set attributeName="visibility" to="hidden" begin="seg2del.end+1s"/>
  </g>

  <!-- Segment 3 -->
  <g id="seg3" visibility="hidden">
    <path id="p3" d="M0,50 H0" fill="none"/>
    <animate id="seg3draw" href="#p3" attributeName="d"
             values="M0,50 H0;M0,50 H500" dur="2s"
             begin="seg2del.end" fill="freeze"/>
    <animate id="seg3del" href="#p3" attributeName="d"
             values="M0,50 H500;M0,50 H0" dur="1s"
             begin="seg3draw.end" fill="freeze"/>
    <text id="text3" class="typewriter"
          font-family="system-ui" font-size="32" font-weight="bold"
          text-anchor="middle" x="50%" y="50" dominant-baseline="middle"
          fill="#e296d2">
      <textPath href="#p3">第三段文字</textPath>
      <set attributeName="fill" to="#e296d2" begin="seg3del.begin"/>
    </text>
    <text class="typewriter" visibility="hidden"
          font-family="system-ui" font-size="32" font-weight="bold"
          text-anchor="middle" x="50%" y="50" dominant-baseline="middle"
          fill="#e296d2">
      <textPath href="#p3" startOffset="100%">|</textPath>
      <animate attributeName="opacity" values="1;0;1" dur="1s"
               begin="seg3del.end" repeatCount="1" calcMode="discrete"/>
      <set attributeName="visibility" to="visible" begin="seg3del.end"/>
    </text>
    <set attributeName="visibility" to="visible" begin="seg2del.end"/>
    <set attributeName="visibility" to="hidden" begin="seg3del.end+1s"/>
  </g>

  <!-- Segment 4 -->
  <g id="seg4" visibility="hidden">
    <path id="p4" d="M0,50 H0" fill="none"/>
    <animate id="seg4draw" href="#p4" attributeName="d"
             values="M0,50 H0;M0,50 H500" dur="2s"
             begin="seg3del.end" fill="freeze"/>
    <animate id="seg4del" href="#p4" attributeName="d"
             values="M0,50 H500;M0,50 H0" dur="1s"
             begin="seg4draw.end" fill="freeze"/>
    <text id="text4" class="typewriter"
          font-family="system-ui" font-size="32" font-weight="bold"
          text-anchor="middle" x="50%" y="50" dominant-baseline="middle"
          fill="#c1b3ce">
      <textPath href="#p4">第四段文字</textPath>
      <set attributeName="fill" to="#c1b3ce" begin="seg4del.begin"/>
    </text>
    <text class="typewriter" visibility="hidden"
          font-family="system-ui" font-size="32" font-weight="bold"
          text-anchor="middle" x="50%" y="50" dominant-baseline="middle"
          fill="#c1b3ce">
      <textPath href="#p4" startOffset="100%">|</textPath>
      <animate attributeName="opacity" values="1;0;1" dur="1s"
               begin="seg4del.end" repeatCount="1" calcMode="discrete"/>
      <set attributeName="visibility" to="visible" begin="seg4del.end"/>
    </text>
    <set attributeName="visibility" to="visible" begin="seg3del.end"/>
    <set attributeName="visibility" to="hidden" begin="seg4del.end+1s"/>
  </g>

  <!-- Invisible loop trigger -->
  <animate id="loop" href="#p1" attributeName="d"
           begin="seg4del.end+0.1s" dur="0.1s" fill="freeze"/>

</svg>
